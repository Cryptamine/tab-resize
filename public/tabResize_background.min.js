localStorage.getItem("updateBadge")||(localStorage.setItem("updateBadge",0),chrome.browserAction.setBadgeText({text:"NEW"}),chrome.browserAction.setBadgeBackgroundColor({color:[221,129,39,255]})),localStorage.getItem("version")||localStorage.setItem("version","2.1");var util={createNewWindow:function(a,b,c,d,e,f,g){var h={left:b,top:c,width:d,height:e,incognito:f};a&&(h.tabId=$.isArray(a)?a[0]:a),window.chrome.windows.create(h,function(b){g(b,a)})},processTabs:function(a,b,c,d,e,f){for(var g,h,i,j=b.slice(c),k=0,l=0,m=j.length,n=a.numRows*a.numCols-m,o=this,p=function(b,c){!c&&a.emptyTab?(j.push(b.tabs[0]),l++,n===l&&o.updateUndoStorage(a,j)):c&&$.isArray(c)&&chrome.tabs.move(c.slice(1),{windowId:b.id,index:1})},q=0;q<a.numRows;q++)for(var r=0;r<a.numCols;r++){if(h="left"===a.alignment?r*a.width+a.offsetX:a.fullWidth-(r+1)*a.width+a.offsetX,i=q*a.height+a.offsetY,0===r&&0===q){if(window.chrome.windows.update(j[k].windowId,{left:h,top:i,width:a.width,height:a.height,state:"normal"}),e)return}else{if(g=j[k]?j[k].id:null,!g&&!a.emptyTab)return;if(q===a.numRows-1&&r===a.numCols-1&&m-k>1){g=[];for(var s=k;m>s;s++)g.push(j[s].id)}o.createNewWindow(g,h,i,a.width,a.height,f,p)}k++}},setUndoStorage:function(a,b,c,d,e){window.chrome.windows.get(c,{},function(a){var f={left:a.left,top:a.top,width:a.width,height:a.height,focused:!0,state:"normal",incognito:a.incognito},g={};g.lastWindowInfo=f,g.lastTabIndex=b,g.lastWindowId=c;for(var h=[],i=0;i<d.length;i++)h.push(d[i].id);g.lastTabsArray=h,localStorage.setItem("lastTab",JSON.stringify(g)),chrome.runtime.sendMessage("enable-undo"),e()})},updateUndoStorage:function(a,b){for(var c=JSON.parse(localStorage.getItem("lastTab")),d=[],e=0;e<b.length;e++)d.push(b[e].id);c&&(c.lastTabsArray=d,localStorage.setItem("lastTab",JSON.stringify(c)),chrome.runtime.sendMessage("enable-undo"))}};