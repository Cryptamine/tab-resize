function sendTracking(a,b){!deferTracking&&ga&&ga("send","event",a,"clicked",b||"na")}var optOut=localStorage.getItem("tracking-opt-out"),deferTracking=!1;optOut&&"true"===optOut&&(deferTracking=!0),deferTracking||(!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-34217520-2","auto"),ga("set","checkProtocolTask",function(){}),ga("require","displayfeatures"),ga("send","pageview","/index.html")),function(){var a={tabsArray:[],currentTab:null,numRows:0,numCols:0,width:0,height:0,canvasHeight:100,canvasWidth:100,currentLayouts:null,defaultLayouts:{layoutItems:["1x1","1x2","2x1","2x2"]},layoutSprites:{layoutItems:["1x1","1x2","2x1","2x2","1x3","3x1"]},maxSelectorsPerLine:5,maxSelectorContainerWidth:156,maxSelectorContainerHeight:156,singleTab:!1,main_view:{},custom_view:{},options:{},util:{},badgeLimit:7,isMac:-1!==navigator.platform.toUpperCase().indexOf("MAC")};window.resize=a}(),function(){var a=window.resize,b={initialize:function(){a.currentLayouts=JSON.parse(localStorage.getItem("layoutItems")),a.currentLayouts||(localStorage.setItem("layoutItems",JSON.stringify(a.defaultLayouts)),a.currentLayouts=$.extend(!0,{},a.defaultLayouts)),this.populateMainView();var b=localStorage.getItem("singleTab");b&&"true"===b&&($("#checkbox-single-tab").attr("checked",!0),$("label.single-tab").addClass("selected"),$("body").addClass("single-tab-selected"),a.singleTab=!0);var c=localStorage.getItem("emptyTab");c&&"true"!==c?$("body").addClass("empty-tab-not-selected"):($("#checkbox-empty-tab").attr("checked",!0),$("label.empty-tab").addClass("selected"),a.emptyTab=!0);var d=localStorage.getItem("displayLayer");d&&"true"!==d||($(".main-view").addClass("display-selected"),a.displayLayer=!0);var e=localStorage.getItem("alignment");e?(a.alignment=e,"left"!==a.alignment&&$("body").addClass("align-right")):a.alignment="left",$("#"+a.alignment).trigger("click",["defer-tracking"]),a.displayUtil.initialize(),localStorage.getItem("lastTab")&&$("#undo-layout").removeClass("disabled"),window.backJs=chrome.extension.getBackgroundPage(),chrome.runtime.onMessage.addListener(function(b){"enable-undo"===b&&a.options.enableUndoButton()});var f=Number(localStorage.getItem("updateBadge"));f||(localStorage.setItem("updateBadge",0),chrome.browserAction.setBadgeText({text:"NEW"}),chrome.browserAction.setBadgeBackgroundColor({color:[221,129,39,255]})),f<a.badgeLimit&&(localStorage.setItem("updateBadge",++f),f===a.badgeLimit&&chrome.browserAction.setBadgeText({text:""}));var g=localStorage.getItem("version")||"",h="2.1.1">g&&""!==g,i=$("body");(!localStorage.getItem("update-seen")||h)&&(i.addClass("update"),h?localStorage.removeItem("update-seen"):localStorage.getItem("warning-seen")||(i.addClass("warning"),a.options.showWarningModal()),a.options.showUpdateModal(h?"partial-update":"")),localStorage.getItem("update-seen")&&f===a.badgeLimit&&!localStorage.getItem("promo-seen")&&(i.addClass("promo"),a.options.showPromoModal()),$(function(){a.util.initSortable()})},populateMainView:function(){for(var b=0;b<a.currentLayouts.layoutItems.length;b++)a.layout.addLayoutMarkup(a.currentLayouts.layoutItems[b],!1)},initWindowWidth:function(){var b=a.currentLayouts.layoutItems.length;$("body").width(b<a.maxSelectorsPerLine?b*a.maxSelectorContainerWidth:a.maxSelectorsPerLine*a.maxSelectorContainerWidth)},checkWindowHeight:function(){var b=a.currentLayouts.layoutItems.length,c=b%a.maxSelectorsPerLine;b>=5&&0===c&&($("body").height($("body").height()-a.maxSelectorContainerHeight),$("html").height($("html").height()-a.maxSelectorContainerHeight))},resizeTabs:function(b,c){a.numRows=b,a.numCols=c;var d=$(".display-entry.selected").data();$.isEmptyObject(d)?(a.width=Math.round(window.screen.availWidth/a.numCols),a.height=Math.round(window.screen.availHeight/a.numRows),a.offsetX=0,a.offsetY=0,a.fullWidth=window.screen.availWidth,a.fullHeight=window.screen.availHeight):(a.width=Math.round(d.width/a.numCols),a.height=Math.round(d.height/a.numRows),a.offsetX=d.left,a.offsetY=d.top,a.fullWidth=d.width,a.fullHeight=d.height);window.chrome.tabs.query({currentWindow:!0},function(b){a.tabsArray=b,window.chrome.tabs.query({currentWindow:!0,highlighted:!0},function(b){a.currentTab=b[0];var c=a.currentTab.index;b.length>1&&(a.tabsArray=b,c=0);var d=function(){return backJs.util.processTabs(a,a.tabsArray,c,a.currentTab.windowId,a.singleTab,a.currentTab.incognito)};a.singleTab?backJs.util.setUndoStorage(a,a.currentTab.index,a.currentTab.windowId,a.tabsArray.slice(c,c+1),d):backJs.util.setUndoStorage(a,a.currentTab.index,a.currentTab.windowId,a.tabsArray.slice(c),d)})})}};window.resize.main_view=b}(),function(){var a=window.resize,b={hideCustomMenu:function(){$(".custom-view").addClass("hidden"),$(".main-view").removeClass("inactive"),a.util.clearCanvas()},showCustomMenu:function(){this.clearCustomValues(),$(".main-view").addClass("inactive"),$(".custom-view").removeClass("hidden").trigger("show"),$(".custom-view input.row").focus()},clearCustomValues:function(){$("#numRows").val(""),$("#numCols").val(""),$("#input-save").addClass("disabled")},handleCustomSave:function(){var b=$("#numRows").val(),c=$("#numCols").val();if(this.clearCustomValues(),!Number(b)||!Number(c)||Number(b)<1||Number(c)<1);else{var d=b+"x"+c;a.layout.addLayout(d),a.layout.processTabInfo($(".layout-"+d)),this.hideCustomMenu()}}};window.resize.custom_view=b}(),function(){var a=window.resize,b={processSingleTabSelection:function(b){var c=b?!0:!1;localStorage.setItem("singleTab",c),a.singleTab=c,$("label.single-tab").toggleClass("selected"),$("body").toggleClass("single-tab-selected")},processEmptyTabSelection:function(b){var c=b?!0:!1;localStorage.setItem("emptyTab",c),a.emptyTab=c,$("label.empty-tab").toggleClass("selected"),$("body").toggleClass("empty-tab-not-selected")},processDisplayLayerSelection:function(b){var c=b?!0:!1;localStorage.setItem("displayLayer",c),a.displayLayer=c},processAlignmentSelection:function(b){localStorage.setItem("alignment",b),a.alignment=b,"right"===b?$("body").addClass("align-right"):$("body").removeClass("align-right")},undoResize:function(){var b=this;a.lastTab=JSON.parse(localStorage.getItem("lastTab"));var c=a.lastTab.lastTabIndex,d=a.lastTab.lastWindowId,e=a.lastTab.lastTabsArray;window.chrome.windows.get(d,{},function(f){f?b.recombineTabs(c,d,e):chrome.tabs.query({status:"complete"},function(c){for(var d={},f=[],g=0;g<c.length;g++)d[c[g].id]=!0;for(var h=0;h<e.length;h++)d[e[h]]&&f.push(e[h]);0!==f.length?chrome.windows.create({tabId:f[0]},function(a){b.recombineTabs(1,a.id,f.slice(1))}):(a.isMac||alert("Previous tabs were closed."),b.disableUndoButton())})})},recombineTabs:function(b,c,d){var e=b;window.chrome.tabs.move(d,{windowId:c,index:e});var f=a.lastTab.lastWindowInfo,g=$.extend(!0,{},f);delete g.incognito,window.chrome.windows.update(c,g),this.disableUndoButton()},disableUndoButton:function(){a.lastTab=null,localStorage.removeItem("lastTab"),$("#undo-layout").addClass("disabled")},enableUndoButton:function(){$("#undo-layout").removeClass("disabled")},hideConfirmationModal:function(){$(".main-view").removeClass("inactive"),$(".confirmation-modal").addClass("hidden")},showConfirmationModal:function(){$(".confirmation-modal").removeClass("hidden").trigger("show"),$(".main-view").addClass("inactive")},hideUpdateModal:function(){$("body").removeClass("update"),$(".main-view").removeClass("inactive"),localStorage.setItem("update-seen",!0),localStorage.setItem("version","2.1.1")},showUpdateModal:function(a){$("#update-modal").addClass(a).trigger("show"),$(".main-view").addClass("inactive")},hidePromoModal:function(){$("body").removeClass("promo"),$(".main-view").removeClass("inactive"),localStorage.setItem("promo-seen",!0)},showPromoModal:function(){$("#promo-modal").trigger("show"),$(".main-view").addClass("inactive")},hideWarningModal:function(){$("body").removeClass("warning"),localStorage.setItem("warning-seen",!0)},showWarningModal:function(){$("#warning-modal").trigger("show"),$(".main-view").addClass("inactive")}};window.resize.options=b}(),function(){function a(a,b,c){for(var d=1;b<c.length&&5>d;b++,d++){a=c[b];var e=$(".resize-container").find(".tab-layer-"+d);e.addClass("valid-tab");for(var f=0;f<e.length;f++)a.favIconUrl&&0!==a.favIconUrl.indexOf("chrome://")&&e.eq(f).find(".fav-icon").css("background-image",'url("'+a.favIconUrl+'")'),e.eq(f).attr("title",a.title)}}var b=window.resize,c={updateLayoutStore:function(){for(var a=$(".resize-selector"),c=a.length,d=0,e=[];c>d;d++)e.push(a.eq(d).attr("data-selector-type"));b.currentLayouts.layoutItems=e,localStorage.setItem("layoutItems",JSON.stringify(b.currentLayouts))},addLayout:function(a){var c=b.currentLayouts.layoutItems,d=c.indexOf(a);-1!==d&&(c.splice(d,1),this._removeLayoutMarkup(a)),b.currentLayouts.layoutItems.unshift(a),localStorage.setItem("layoutItems",JSON.stringify(b.currentLayouts)),this.addLayoutMarkup(a,!0),b.util.resetSortable()},addLayoutMarkup:function(a,c){var d="layout-default";(-1!==b.layoutSprites.layoutItems.indexOf(a)||"1x1"===a)&&(d="layout-"+a);var e=$(".resize-container"),f='<li class="resize-selector-container"><div class="close-button"></div><div class="layout-title">'+a+'</div><div class="resize-selector '+d+'" data-selector-type="'+a+'"></div></li>';c?e.prepend(f):e.append(f)},removeLayout:function(a){var c=b.currentLayouts.layoutItems,d=c.indexOf(a);c.splice(d,1),localStorage.setItem("layoutItems",JSON.stringify(b.currentLayouts)),this._removeLayoutMarkup(a)},_removeLayoutMarkup:function(a){var b='[data-selector-type="'+a+'"]';$(b).parent().remove()},resetLayout:function(){this._removeAllLayouts(),localStorage.setItem("layoutItems",JSON.stringify(b.defaultLayouts)),b.currentLayouts=$.extend(!0,{},b.defaultLayouts),b.main_view.populateMainView(),this.processTabInfo(),b.util.resetSortable()},_removeAllLayouts:function(){$(".resize-container").children().remove()},processTabInfo:function(c){var d,e,f,g,h,i,j,k=b.currentWindowTabs,l=c||$(".resize-container").find(".resize-selector-container .resize-selector"),m=0,n=0;if(l=l.filter(function(){return!$(this).hasClass("layout-default")}),m=l.length,k&&k.length>0){for(;m>n;n++){h="",d=l.eq(n),e=d.attr("data-selector-type").split("x"),f=e[0],g=e[1],j=1;for(var o=0;f>o;o++)for(var p=0;g>p;p++)h+='<div title="New Tab" class="tab-layer tab-layer-'+j++ +'"><div class="fav-icon"></div></div>';d.html(h)}for(n=0;n<k.length;n++)if(i=k[n],i.highlighted){a(i,n,k);break}}}};window.resize.layout=c}(),function(){var a={centerModal:function(a){a.css({"margin-top":a.outerHeight()/2*-1,"margin-left":a.outerWidth()/2*-1})},drawTable:function(a,b,c,d,e){e.beginPath();for(var f=a/d,g=b/c,h=1;c>h;h++)e.moveTo(0,g*h),e.lineTo(b,g*h);for(var i=1;d>i;i++)e.moveTo(f*i,0),e.lineTo(f*i,a);e.closePath(),e.stroke()},clearCanvas:function(){var a=$("canvas")[0],b=a.getContext("2d");b.clearRect(0,0,b.canvas.width,b.canvas.height)},initSortable:function(){$(".sortable").sortable().on("sortupdate",function(){resize.layout.updateLayoutStore(),sendTracking("dnd-event","dnd-label")}),b=!0},resetSortable:function(){if(b){var a=$(".sortable");a.sortable("destroy"),a.sortable()}}},b=!1;window.resize.util=a}(),function(a){function b(a){for(var b,e,f,g,h,l=a.displays,m=null,n=null,o=null,p=null,q=0,r=l.length;r>q;q++)h=l[q].workArea,(null===m||m>h.left)&&(m=h.left),(null===n||n<h.left+h.width)&&(n=h.left+h.width),(null===o||o>h.top)&&(o=h.top),(null===p||p<h.top+h.height)&&(p=h.top+h.height);b=n-m,e=p-o,availableArea=c(),f=availableArea.width/b,g=availableArea.height/e,i=g>f?f:g,j=0!==m?-1*m*i:0,k=0!==o?-1*o*i:0,d(i,e)}function c(){a("#display-setting-layer");return{width:l,height:m}}function d(b,c){var d=a("#display-setting-layer");d.height(b*c)}function e(a,b){for(var c,d=0,e=a.length,f={displays:[],primaryIndex:0};e>d;d++)c=a[d],c.id=String(d),f.displays.push({workArea:c.workArea,isEnabled:c.isEnabled,id:c.id}),b.left>c.workArea.left&&b.left<c.workArea.left+c.workArea.width&&b.top>c.workArea.top&&b.top<c.workArea.top+c.workArea.height&&(f.primaryIndex=d);return f}function f(b,c,d){var e=a('<div class="display-entry" title="Please select display to use."><div class="display-meta"></div></div>');return e.css({top:b.top*i+k,left:b.left*i+j,width:b.width*i,height:b.height*i}).data(a.extend({id:c},b)),e.find(".display-meta").text(b.width+"x"+b.height),d&&e.addClass("selected"),e}var g,h=window.resize,i=.15,j=0,k=0,l=530,m=250,n={initialize:function(){chrome.system&&chrome.system.display&&(h.display=chrome.system.display,g=a("#display-setting-layer"),g.on("click",".display-entry",function(){var b=a(this),c={},d=b.data("id"),e=b.find(".display-meta").text();c[d]=!0,g.find(".display-entry").removeClass("selected"),b.addClass("selected"),sendTracking("display-select",e)}),h.display.getInfo(function(a){chrome.windows.getCurrent({populate:!0},function(c){var d,i,j={left:c.left+c.width-100,top:c.top+100},k=e(a,j);b(k);for(var l=0;l<k.displays.length;l++)i=k.displays[l],d=f(i.workArea,i.id,k.primaryIndex===l),g.append(d);chrome.tabs.query({currentWindow:!0,highlighted:!0},function(a){h.currentWindowTabs=a.length>1?a:c.tabs,h.layout.processTabInfo()})})}))}};h.displayUtil=n}(window.jQuery),function(){var a=window.resize,b=a.main_view,c=a.custom_view,d=a.util,e=a.layout,f=a.options,g=(a.displayUtil,$(document));g.ready(function(){b.initialize()}).on("click",".resize-selector-container",function(){var a=$(this).children(".resize-selector"),c=a.attr("data-selector-type"),d=c.split("x");b.resizeTabs(Number(d[0]),Number(d[1])),sendTracking("resize",c)}).on("show",".modal-box",function(a){a.stopPropagation(),d.centerModal($(this))}).on("click",".modal-box",function(a){a.stopPropagation()}).on("click",".close-button",function(a){a.stopPropagation();var b=$(this).siblings(".resize-selector").attr("data-selector-type");e.removeLayout(b),sendTracking("resize-delete",b)}).on("click","#undo-layout",function(){f.undoResize(),sendTracking("undo","undo")}).on("click","#custom-layout",function(a){a.stopPropagation(),c.showCustomMenu(),sendTracking("custom-layout","open")}).on("click","#default-configuration",function(a){a.stopPropagation(),f.showConfirmationModal(),sendTracking("default-layout","open")}).on("click","#confirmation-cancel",function(){f.hideConfirmationModal(),sendTracking("default-layout","cancel")}).on("click","#confirmation-apply",function(){e.resetLayout(),f.hideConfirmationModal(),sendTracking("default-layout","apply")}).on("click","#input-cancel,.main-view",function(){$(".custom-view").hasClass("hidden")||(c.clearCustomValues(),c.hideCustomMenu(),sendTracking("custom-layout","cancel"))}).on("click","#input-save",function(){c.handleCustomSave(),sendTracking("custom-layout","apply")}).on("click","body",function(){$(".custom-view").hasClass("hidden")||(d.clearCanvas(),c.hideCustomMenu(),sendTracking("custom-layout","cancel-layer")),$(".confirmation-modal").hasClass("hidden")||(f.hideConfirmationModal(),sendTracking("default-layout","cancel-layer"))}).on("keyup","#numRows, #numCols",function(b){b.stopPropagation();var c=document.getElementById("myCanvas"),e=c.getContext("2d"),f=Number($("#numRows").attr("value")),g=Number($("#numCols").attr("value"));if(d.clearCanvas(),f&&f>0&&g&&g>0)f>a.canvasHeight/4&&(f=a.canvasHeight/4),g>a.canvasWidth/4&&(g=a.canvasWidth/4),d.drawTable(a.canvasWidth,a.canvasHeight,f,g,e),$("#input-save").removeClass("disabled");else{var h=$(this),i=Number(h.attr("value"));(0===i||isNaN(i))&&(h.attr("value",""),$("#input-save").addClass("disabled"))}}).on("change","#checkbox-single-tab",function(){var a=$(this).attr("checked");f.processSingleTabSelection(a),sendTracking("single-tab",a?"checked":"unchecked")}).on("change","#checkbox-empty-tab",function(){var a=$(this).attr("checked");f.processEmptyTabSelection(a),sendTracking("empty-tab",a?"checked":"unchecked")}).on("click","#display-setting",function(){var a,b=$(".main-view");b.toggleClass("display-selected"),a=b.hasClass("display-selected"),f.processDisplayLayerSelection(a),sendTracking("display-settings",a?"opened":"closed")}).on("click","#display-setting-layer .switch-toggle input",function(a,b){var c=$(this).attr("id");$(".switch-toggle").removeClass("right-align left-align").addClass(c+"-align"),f.processAlignmentSelection(c),b||sendTracking("alignment",c)}).on("click","#update-apply",function(){f.hideUpdateModal()}).on("click","#promo-apply",function(){f.hidePromoModal()}).on("click","#warning-apply",function(){f.hideWarningModal()}).on("click",".signature a",function(){$(this).hasClass("rate-it")?sendTracking("info-links","rate-it"):sendTracking("info-links","author")})}();